db_name = "dfs://snapshot_SH_L2_TSDB"
tb_name = "snapshot_SH_L2_TSDB"     
db = database(db_name)
tb = db.loadTable(tb_name)

// 查询总数
select count(*) from tb

// 点查询
select * from tb where securityid = 'sz002582',
tradetime = 2016.03.11

// 范围查询
select securityid, tradetime, open, close from tb 
where securityid in ('sz002582', 'sz001900', 'sz003183', 'sz000002'),
date(tradetime) between 2010.01.22 : 2010.03.01,
open < 60

// top1000+排序
select top 1000 * from tb
where securityid in ('sz000001', 'sz000002', 'sz000003', 'sz000004'),
close > open
order by (close - open) desc
// time >= 07:36:37,

// 聚合查询：单分区维度
select max(close) as max_close, min(open) as min_open from tb
where securityid = 'sz001664',
close > open
group by month(tradetime)

// 聚合查询：多分区维度 + 排序
select std(open) as std_open, sum(close) as sum_close from tb
where
securityid in ('sz000922', 'sz003925', 'sz000505', 'sz002435'),
tradetime >= timestamp("2000.01.01 00:00:00")
group by securityid, month(tradetime)
order by securityid asc


// 经典查询：按 [多个股票代码、日期，时间范围、报价范围] 过滤，查询 [股票代码、时间、卖方与买方报价]
select * from tb
where
securityid in ('sz002435', 'sz002436', 'sz002436', 'sz002436'),
date(tradetime) = 2015.10.29,
close > open

// 窗口计算：查询某只股票某天内时间的差值
select securityid, tradetime, deltas(bid) as time_diff from tb
where
symbol = 'WXXXX',
date = 2000.09.04
order by time asc
// (182 ms)(10 ms)(12 ms)(10 ms)

// 聚合计算：计算某天中每个股票在每分钟的最大卖方报价与最小买方报价之差
select max(ofr) - min(bid) as gap from tb
where
date = 2000.08.01,
bid > 0,
ofr > bid
group by symbol, minute(time) as minute
// (94 ms)(145 ms)(88 ms)(93 ms)

// 统计计算：计算某天中某列的中位数（ClickHouse查询median时是近似结果，而DolphinDB是精确结果）
select median(ofr), median(bid) from tb
where
date = 2000.08.10,
symbol = 'YXXXX'
// (46 ms)(5 ms)(8 ms)(9 ms)
clickhouse-benchmark [keys] <<< "select * from db_chtest.tb_chtest"